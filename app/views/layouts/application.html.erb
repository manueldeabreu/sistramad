<!DOCTYPE html>
<html>
<head>
  <title>Sistramad</title>
  <%= csrf_meta_tags %>
  <%= action_cable_meta_tag %>
  <%= stylesheet_link_tag 'application', media: 'all' %>
  <%= javascript_include_tag 'application'%>

  <%= csrf_meta_tags %>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
  <script type="text/javascript" src="https://cdn.jsdelivr.net/bootstrap.filestyle/1.1.0/js/bootstrap-filestyle.min.js"> </script>
</head>

<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">
<%= render "partials/navigation" %>

<% if ['sessions', 'passwords', 'unlocks'].include?(controller_name) %>
    <div id="background"></div>
<% end %>

  <% if ['sessions', 'passwords', 'unlocks', 'invitations'].include?(controller_name) %>
      <%= yield %>
  <% else %>

      <aside class="main-sidebar">

        <!-- sidebar: style can be found in sidebar.less -->
        <section class="sidebar">

          <!-- Sidebar user panel (optional) -->
          <% if !current_user.nil?  %>
          <div class="user-panel">
            <div class="pull-left image">
              <% if current_user.avatar.present? %>
                <%= image_tag (current_user.avatar.url), :class=>"img-circle" , :alt=>"User Image"%>-->
              <% else %>
                <% if current_user.genre == "m"%>
                <%= image_tag "user2-160x160.jpg" , :class=>"img-circle", :alt=>"User Image"%>
                <% else %>
                <%= image_tag "female_user.png" , :class=>"img-circle", :alt=>"User Image"%>
                <% end %>
              <% end %> 
            </div>
            <div class="pull-left info">
            <% if user_signed_in? %>
              <div><%= current_user.first_name %> <%= current_user.last_name %></div>
            <% end %>
              <!-- Status -->
              <a href="#"><i class="fa fa-circle text-success"></i>en linea</a>
            </div>
          </div>
          <% end %>

          <!-- search form (Optional) -->
          <form action="#" method="get" class="sidebar-form">
            <div class="input-group">
              <input type="text" name="q" class="form-control" placeholder="Search...">
              <span class="input-group-btn">
                <button type="submit" name="search" id="search-btn" class="btn btn-flat"><i class="fa fa-search"></i>
                </button>
              </span>
            </div>
          </form>
          <!-- /.search form -->

          <!-- Sidebar Menu -->
          <ul class="sidebar-menu">
            <li class="header">TR&Aacute;MITES</li>
            <!-- Optionally, you can add icons to the links -->
            
            <li><a href="#"><i class="fa fa-circle-o"></i> <span>Plan Septenal</span></a></li>

            <li><a href="#"><i class="fa fa-circle-o"></i> <span>Ascenso</span></a></li>

            <li>
              <%= link_to special_formation_procedures_path(code: "T-SPF200") do %>
                <i class="fa fa-circle-o"></i>
                <span> Formación Especial</span></a>
              <% end %>
            <li>

            <li>
              <%= link_to rotation_plans_path(code: "T-SPR201") do %>
                <i class="fa fa-circle-o"></i>
                <span> Plan de Rotación</span></a>
              <% end %>
            <li>

            <li>
              <%= link_to licenses_path(code: "T-SLR204") do %>
                <i class="fa fa-circle-o"></i>
                <span>Licencias</span></a>
              <% end %>
            <li>

            <li><a href="/procedures"><i class="fa fa-circle-o"></i> <span>Año Sabatico</span></a></li>
            
            <li class="treeview">
              <a href="#"><i class="fa fa-circle-o"></i> <span>Traslados</span>
              <span class="pull-right-container">
                <i class="fa fa-angle-left pull-right"></i>
              </span>
              </a>
              <ul class="treeview-menu">
               <% if (ProfessorsTransfer.where('process_type = ? and user_id =?',1,current_user.id).empty? && (current_user.has_role? :docente)) %>
                      <li><%= link_to new_transfer_attachment_path(:tramite => 1),method: :get do%>
                            <i class="fa fa-circle"></i>
                            Solicitar Trámite
                      <% end %>
                      </li>
                <% else %>
                  <% if ProfessorsTransfer.where('process_type = ? and user_id =?',1,current_user.id).present? %>
                    <% if ProfessorsTransfer.where('process_type = ? and user_id =? and status = ?',1,current_user.id,'DR').present? %>
                        <li><%= link_to new_transfer_attachment_path(:tramite => 1 ),method: :get do%>
                                <i class="fa fa-circle"></i>
                                Enviar Recaudos Faltantes
                        <% end %>
                          </li>
                    <% elsif ProfessorsTransfer.where('process_type = ? and user_id =? and status = ?',1,current_user.id,'CL').present? %>
                        <li><%= link_to new_transfer_attachment_path(:tramite => 1 ),method: :get do%>
                                <i class="fa fa-circle"></i>
                                Solicitar Traslado
                        <% end %>
                          </li>
                    <% end %>
                    <li><%= link_to status_professors_transfers_path ,method: :get do%>
                        <i class="fa fa-circle"></i>
                        Estatus de Traslado
                  <% end %>
                    </li> 
                  <% end %> 
                <% end %>
                </ul> 
            </li>

            <li class="treeview">
            <a href="#"><i class="fa fa-circle-o"></i> <span>Cambios en Dedicación</span>
            <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
            </a>
              <ul class="treeview-menu">
                <% if (ProfessorsTransfer.where('process_type = ? and user_id =?',3,current_user.id).empty? && (current_user.has_role? :docente) && (current_user.employee.present?))%>
                <li><%= link_to new_transfer_attachment_path(:tramite => 3),method: :get do%>
                      <i class="fa fa-circle"></i>
                      Solicitar Trámite
                <% end %>
                </li>
                <% else %>
                  <% if ProfessorsTransfer.where('process_type = ? and user_id =?',3,current_user.id).present? %>
                    <% if ProfessorsTransfer.where('process_type = ? and user_id =? and  status = ?',3,current_user.id,'DR').present? %>
                      <li><%= link_to new_transfer_attachment_path(:tramite => 3 ),method: :get do%>
                              <i class="fa fa-circle"></i>
                              Enviar Recaudos Faltantes
                      <% end %>
                        </li>
                    <% elsif ProfessorsTransfer.where('process_type = ? and user_id =? and status = ?',3,current_user.id,'CL').present? %>
                        <li><%= link_to new_transfer_attachment_path(:tramite => 3 ),method: :get do%>
                                <i class="fa fa-circle"></i>
                                Solicitar Cambio de Dedicación
                        <% end %>
                          </li>
                    <% end %>
                      <li><%= link_to status_professors_transfers_path ,method: :get do%>
                        <i class="fa fa-circle"></i>
                        Estatus de Trámite
                      <% end %>
                    </li> 
                <% end %> 
                <% end %>   
                <% if ((current_user.has_role? :decano) || (current_user.has_role? :consejo_departamento)|| (current_user.has_role? :consejo_escuela) || (current_user.has_role? :consejo_facultad) || (current_user.has_role? :departamento) || (current_user.has_role? :consejo_universitario))%>
                    <li><%= link_to professors_transfers_path do%>
                        <i class="fa fa-circle-o"></i>
                        Ver Solicitudes de Traslados
                    <% end %></li>
                <% end %>
              </ul>
            </li>

            <li><a href="#"><i class="fa fa-circle-o"></i> <span>Regimen de Beca</span></a></li>


            <li class="treeview">
                <a href="#"><i class="fa fa-circle-o"></i> <span>Plan Conjunto</span>
                  <span class="pull-right-container">
                    <i class="fa fa-angle-left pull-right"></i>
                  </span>
                </a>
                <ul class="treeview-menu">
                  <% if JointPlan.where(user_id: current_user.id).empty? %>
                      <li><%= link_to new_attachment_path,method: :get do%>
                            <i class="fa fa-circle"></i>
                            Nuevo Plan Conjunto
                        <% end %></li>
                  <% end %>
                  <li><%= link_to status_joint_plans_path,method: :get do%>
                      <i class="fa fa-circle"></i>
                      Estatus de Plan Conjunto
                  <% end %>
                  </li>
                  <li><%= link_to inform_joint_plans_path,method: :get do%>
                        <i class="fa fa-circle"></i>
                        Subir Informe
                    <% end %>
                  </li>
                  <li><%= link_to extension_joint_plans_path,method: :get do%>
                        <i class="fa fa-circle"></i>
                        Solicitar Extensión de Plazo
                    <% end %>
                  </li>
                </ul>
            </li>


            <% if current_user.has_role? :asuntos_profesorales %>
                <li><%= link_to joint_plans_path do%>
                      <i class="fa fa-circle-o"></i>
                      <span>Ver Solicitudes</span></a>
                  <% end %></li>
                <li><%= link_to inform_list_joint_plans_path do%>
                      <i class="fa fa-circle-o"></i>
                      <span>Informes</span></a>
                  <% end %></li>
            <% end %>
            <% if current_user.has_role? :decano %>
                <li><%= link_to joint_plans_path do%>
                    <i class="fa fa-circle-o"></i>
                    <span>Ver Solicitudes</span></a>
                <% end %></li>
            <% end %>
            
          </ul>
          <!-- /.sidebar-menu -->
        </section>
        <!-- /.sidebar -->
      </aside>


      <div class="content-wrapper">
        <% flash.each do |name, msg| -%>
            <div class="alert alert-<%= name %>">
              <div class="container-fluid">
                <button class="close" data-dismiss="alert"><span>&times;</span></button>
                <%= content_tag :div, msg %>
              </div>
            </div>
        <% end -%>
        <!-- Content Header (Page header) -->
        <section class="content-header">
          <!--
          <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i> Level</a></li>
            <li class="active">Here</li>
          </ol>
          -->
        </section>

        <!-- Main content -->
        <section class="content">
          <!-- Your Page Content Here -->
          <%= yield %>
          <!-- 
            <%= debug(params) if Rails.env.development? %>
          -->
        </section>
      </div>

      <footer class="main-footer">
        <!-- To the right -->
        <div class="pull-right hidden-xs">
          Sistema Automatizado de Trámites Docentes
        </div>
        <!-- Default to the left -->
        <strong>Universidad de Carabobo &copy; 2017 </strong> 
      </footer>
  <% end %>
</div>
</body>
</html>
